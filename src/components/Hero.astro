---
import { getEventData } from "../data/eventData";
const { hero, countdown } = getEventData();
import bgImage from '../assets/Background.jpg';

const eventDate = countdown.target;
const eventLabel = countdown.label;
const eventLocation = countdown.location;
---

<section
    id="hero" style={`background-image: url(${bgImage.src}); background-size: cover; background-position: center; position: relative;`}
    class="hero relative overflow-hidden bg-[var(--color-primary) hero-with-bg-image]"
    data-countdown
    data-countdown-target={eventDate}
>
    <div class="w-full px-6 pt-10 pb-8 md:py-28 lg:py-36">
        <div class="mx-auto flex w-full max-w-6xl flex-col gap-12">
            
            <!-- TESTI PRINCIPALI -->
            <div class="flex flex-col gap-6 text-center">
                <h1
                    class="font-display text-[clamp(3.5rem,8vw,6.5rem)] uppercase leading-[0.8] tracking-tight drop-shadow-md text-[var(--color-text-dark)]"
                    id="hero-heading"
                    data-hero-title={`${hero.title} & ${hero.title1}`}
                >
                    {hero.title} <br /> 
                        <span class="block normal-case font-sans text-2xl tracking-normal my-0 italic">&</span> {hero.title1}
                </h1>

                <p class="font-display text-center leading-relaxed md:text-lg opacity-90 text-[var(--color-text-dark)]">
                    {hero.description}
                <p class="font-display text-center leading-relaxed md:text-lg opacity-90 text-[var(--color-text-dark)]">
                    <em>{hero.description1}</em>
                </p>        
            </div>

            <div class="flex flex-col gap-2 text-center md:text-center">
                    <p class="font-display text-2xl tracking-tight uppercase opacity-90 text-black">
                        {hero.weekday}
                    </p>
                    <p class="text-[clamp(1.8rem,7.5vw,3rem)] uppercase tracking-tight text-[var(--color-text-dark)] whitespace-nowrap font-medium">
                        {hero.dateDisplay}
                    </p>
                    <p class="font-display text-1xl  tracking-0.2em uppercase opacity-90 text-[var(--color-text-dark)]">
                        {hero.location}
                    </p>
            </div>

            <!-- COUNTDOWN -->
            <div class="mt-4 flex flex-col items-center justify-center md:items-center gap-4 pt-10">
                <p class="text-[11px] uppercase tracking-[0.35em] text-[var(--color-text-dark)] opacity-80">
                    {eventLabel}
                </p>

                <div class="flex items-baseline gap-6 text-[var(--color-text-dark)]">
                    <div class="flex flex-col items-center">
                        <span class="text-3xl font-400 leading-none" data-days>--</span>
                        <span class="mt-2 text-[9px] uppercase tracking-widest opacity-70">Giorni</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="text-3xl font-400 leading-none" data-hours>--</span>
                        <span class="mt-2 text-[9px] uppercase tracking-widest opacity-70">Ore</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="text-3xl font-400 leading-none" data-minutes>--</span>
                        <span class="mt-2 text-[9px] uppercase tracking-widest opacity-70">Min</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="text-3xl font-400 leading-none" data-seconds>--</span>
                        <span class="mt-2 text-[9px] uppercase tracking-widest opacity-70">Sec</span>
                    </div>
                </div>

                <p class="text-[10px] uppercase tracking-[0.25em] text-black opacity-60">
                    {eventLocation}
                </p>
            </div>

            <div class="mt-2 flex flex-col items-center gap-4">
                
                <a 
                    href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Matrimonio+Anna+%26+Stefano&dates=20260912T153000Z/20260912T233000Z&details=Non+vediamo+l%27ora+di+festeggiare+con+voi%21&location=Sabbia+%26+Sale+Feeling+Beach%2C+Chioggia"
                    target="_blank"
                    class="inline-flex items-center gap-2 px-6 py-3 rounded-full border transition-all hover:bg-white/10 active:scale-95"
                    style="border-color: var(--color-muted); color: var(--color-secondary);"
                >
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <span class="text-[10px] uppercase tracking-widest font-bold">Salva l'evento</span>
                </a>
                </div>

        </div>
    </div>
</section>

<script type="module">
                                                                                                                                                                
    // LOGICA COUNTDOWN
    const initCountdown = () => {
        const root = document.querySelector("[data-countdown]");
        if (!root) return;

        const targetDate = root.dataset.countdownTarget;
        if (!targetDate) return;

        const targets = {
            days: root.querySelector("[data-days]"),
            hours: root.querySelector("[data-hours]"),
            minutes: root.querySelector("[data-minutes]"),
            seconds: root.querySelector("[data-seconds]"),
        };

        const update = () => {
            const diff = new Date(targetDate).getTime() - Date.now();
            if (diff <= 0) return;

            const d = Math.floor(diff / 86400000);
            const h = Math.floor((diff % 86400000) / 3600000);
            const m = Math.floor((diff % 3600000) / 600000);
            const s = Math.floor((diff % 60000) / 1000);

            if (targets.days) targets.days.textContent = String(d).padStart(2, '0');
            if (targets.hours) targets.hours.textContent = String(h).padStart(2, '0');
            if (targets.minutes) targets.minutes.textContent = String(m).padStart(2, '0');
            if (targets.seconds) targets.seconds.textContent = String(s).padStart(2, '0');
        };

        setInterval(update, 1000);
        update();
    };

    initCountdown();
</script>