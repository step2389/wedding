---
// RSVP.astro
import bgImage from '../assets/images/background.jpg';
---

<section id="rsvp" class="relative py-12 sm:py-20">
  <!-- Sfondo che non scatta e non copre il sito -->
  <div 
    class="absolute inset-0 z-0"
    style={`
      background-image: url(${bgImage.src});
      background-size: cover;
      background-position: center;
      background-attachment: scroll;
    `}
  >
    <div class="absolute inset-0 bg-black/20"></div>
  </div>

  <div class="relative z-10 max-w-xl mx-auto px-4">
    <div 
      class="rounded-[2rem] p-6 sm:p-10 shadow-2xl backdrop-blur-md"
      style="
        background-color: var(--color-primary);
        border: 1px solid color-mix(in srgb, var(--color-secondary), transparent 80%);
      "
    >
      <header class="text-center mb-6">
        <h2 
          class="text-2xl sm:text-3xl font-semibold tracking-widest uppercase mb-2"
          style="color: var(--color-secondary); font-family: 'TeX Gyre Termes', serif;"
        >
          Presenza
        </h2>
        <p class="text-xs sm:text-sm" style="color: var(--color-secondary); opacity: 0.8;">
          Conferma la tua partecipazione
        </p>
      </header>

      <form
        action="https://api.web3forms.com/submit"
        method="POST"
        class="flex flex-col gap-4"
      >
        <input type="hidden" name="access_key" value="2bd3aa52-27fe-48ec-9180-a2679432af07" />

        <div class="flex flex-col gap-1">
          <label class="text-[10px] uppercase tracking-widest font-bold" style="color: var(--color-secondary);">Nome e cognome</label>
          <input name="name" type="text" required class="w-full rounded-xl border border-white/20 px-4 py-2 bg-white/10 text-white focus:outline-none focus:border-white" />
        </div>

        <div class="flex flex-col gap-1">
          <label class="text-[10px] uppercase tracking-widest font-bold" style="color: var(--color-secondary);">Email (opzionale)</label>
          <input name="email" type="email" class="w-full rounded-xl border border-white/20 px-4 py-2 bg-white/10 text-white focus:outline-none focus:border-white" />
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="flex flex-col gap-1">
            <label class="text-[10px] uppercase tracking-widest font-bold" style="color: var(--color-secondary);">Parteciperai?</label>
            <select id="attending" name="attending" required class="w-full rounded-xl border border-white/20 px-4 py-2 bg-white/10 text-white appearance-none">
              <option value="yes" class="text-black">SÃ¬</option>
              <option value="no" class="text-black">No</option>
            </select>
          </div>
          <div class="flex flex-col gap-1">
            <label class="text-[10px] uppercase tracking-widest font-bold" style="color: var(--color-secondary);">Ospiti</label>
            <input id="guests" name="guests" type="number" min="1" class="w-full rounded-xl border border-white/20 px-4 py-2 bg-white/10 text-white" />
          </div>
        </div>

        <div class="flex flex-col gap-1">
          <label class="text-[10px] uppercase tracking-widest font-bold" style="color: var(--color-secondary);">Note</label>
          <textarea name="notes" rows="2" class="w-full rounded-xl border border-white/20 px-4 py-2 bg-white/10 text-white"></textarea>
        </div>

        <button
          type="submit"
          class="mt-2 w-full py-3 rounded-full text-xs font-bold uppercase tracking-widest transition-transform active:scale-95 shadow-lg"
          style="background-color: var(--color-secondary); color: var(--color-primary);"
        >
          Invia conferma
        </button>

        <input type="hidden" name="redirect" value="https://wedding-anna-stefano.penz23.org/grazie" />
      </form>
    </div>
  </div>
</section>

<script>
  const attending = document.getElementById("attending");
  const guests = document.getElementById("guests");
  if (attending && guests) {
    attending.addEventListener("change", () => {
      guests.required = (attending.value === "yes");
    });
  }
</script>